

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Tutorial - Time series forecasting &mdash; lightwood 22.6.1.2 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/mindsdblogo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                22.6.1.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Tutorials</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">API</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Data</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../encoder.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Encoders</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mixer.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Mixers</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ensemble.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Ensemble</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analysis.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Analysis</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../helpers.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Helpers</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../lightwood_philosophy.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Lightwood</span> <span class="pre">Philosophy</span></code></a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">lightwood</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Tutorial - Time series forecasting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/tutorials/tutorial_time_series/tutorial_time_series.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Tutorial---Time-series-forecasting">
<h1>Tutorial - Time series forecasting<a class="headerlink" href="#Tutorial---Time-series-forecasting" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Introduction">
<h2>Introduction<a class="headerlink" href="#Introduction" title="Permalink to this headline">¶</a></h2>
<p>Time series are an ubiquitous type of data in all types of processes. Producing forecasts for them can be highly valuable in domains like retail or industrial manufacture, among many others.</p>
<p>Lightwood supports time series forecasting (both univariate and multivariate inputs), handling many of the pain points commonly associated with setting up a manual time series predictive pipeline.</p>
<p>In this tutorial, we will train a lightwood predictor and analyze its forecasts for the task of counting sunspots in monthly intervals.</p>
</div>
<div class="section" id="Load-data">
<h2>Load data<a class="headerlink" href="#Load-data" title="Permalink to this headline">¶</a></h2>
<p>Let’s begin by loading the dataset and looking at it:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/mindsdb/benchmarks/main/benchmarks/datasets/monthly_sunspots/data.csv&quot;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Month</th>
      <th>Sunspots</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1749-01</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1749-02</td>
      <td>62.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1749-03</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1749-04</td>
      <td>55.7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1749-05</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2815</th>
      <td>1983-08</td>
      <td>71.8</td>
    </tr>
    <tr>
      <th>2816</th>
      <td>1983-09</td>
      <td>50.3</td>
    </tr>
    <tr>
      <th>2817</th>
      <td>1983-10</td>
      <td>55.8</td>
    </tr>
    <tr>
      <th>2818</th>
      <td>1983-11</td>
      <td>33.3</td>
    </tr>
    <tr>
      <th>2819</th>
      <td>1983-12</td>
      <td>33.4</td>
    </tr>
  </tbody>
</table>
<p>2820 rows × 2 columns</p>
</div></div>
</div>
<p>This is a very simple dataset. It’s got a single column that specifies the month in which the measurement was done, and then in the ‘Sunspots’ column we have the actual quantity we are interested in forecasting. As such, we can characterize this as a univariate time series problem.</p>
</div>
<div class="section" id="Define-the-predictive-task">
<h2>Define the predictive task<a class="headerlink" href="#Define-the-predictive-task" title="Permalink to this headline">¶</a></h2>
<p>We will use Lightwood high level methods to state what we want to predict. As this is a time series task (because we want to leverage the notion of time to predict), we need to specify a set of arguments that will activate Lightwood’s time series pipeline:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lightwood.api.high_level</span> <span class="kn">import</span> <span class="n">ProblemDefinition</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">INFO:lightwood-2276:No torchvision detected, image helpers not supported.</span>
<span class="ansi-green-fg">INFO:lightwood-2276:No torchvision/pillow detected, image encoder not supported</span>
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tss</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;horizon&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>   <span class="c1"># the predictor will learn to forecast what the next semester counts will look like (6 data points at monthly intervals -&gt; 6 months)</span>
       <span class="s1">&#39;order_by&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">],</span> <span class="c1"># what column is used to order the entire datset</span>
       <span class="s1">&#39;window&#39;</span><span class="p">:</span> <span class="mi">12</span>           <span class="c1"># how many past values to consider for emitting predictions</span>
      <span class="p">}</span>

<span class="n">pdef</span> <span class="o">=</span> <span class="n">ProblemDefinition</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="s1">&#39;Sunspots&#39;</span><span class="p">,</span>         <span class="c1"># specify the column to forecast</span>
                                    <span class="s1">&#39;timeseries_settings&#39;</span><span class="p">:</span> <span class="n">tss</span>    <span class="c1"># pass along all time series specific parameters</span>
                                   <span class="p">})</span>
</pre></div>
</div>
</div>
<p>Now, let’s do a very simple train-test split, leaving 10% of the data to check the forecasts that our predictor will produce:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cutoff</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">*</span><span class="mf">0.9</span><span class="p">)</span>

<span class="n">train</span> <span class="o">=</span> <span class="n">df</span><span class="p">[:</span><span class="n">cutoff</span><span class="p">]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cutoff</span><span class="p">:]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2538, 2) (282, 2)
</pre></div></div>
</div>
</div>
<div class="section" id="Generate-the-predictor-object">
<h2>Generate the predictor object<a class="headerlink" href="#Generate-the-predictor-object" title="Permalink to this headline">¶</a></h2>
<p>Now, we can generate code for a machine learning model by using our problem definition and the data:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lightwood.api.high_level</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">json_ai_from_problem</span><span class="p">,</span>
    <span class="n">code_from_json_ai</span><span class="p">,</span>
    <span class="n">predictor_from_code</span>
<span class="p">)</span>

<span class="n">json_ai</span> <span class="o">=</span> <span class="n">json_ai_from_problem</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">problem_definition</span><span class="o">=</span><span class="n">pdef</span><span class="p">)</span>
<span class="n">code</span> <span class="o">=</span> <span class="n">code_from_json_ai</span><span class="p">(</span><span class="n">json_ai</span><span class="p">)</span>
<span class="n">predictor</span> <span class="o">=</span> <span class="n">predictor_from_code</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

<span class="c1"># uncomment this to see the generated code:</span>
<span class="c1"># print(code)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">INFO:lightwood-2276:Analyzing a sample of 2467</span>
<span class="ansi-green-fg">INFO:lightwood-2276:from a total population of 2820, this is equivalent to 87.5% of your data.</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Infering type for: Month</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Column Month has data type date</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Infering type for: Sunspots</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Column Sunspots has data type float</span>
/home/runner/work/lightwood/lightwood/lightwood/helpers/text.py:245: RuntimeWarning: invalid value encountered in double_scalars
  randomness_per_index.append(S / np.log(N))
<span class="ansi-green-fg">INFO:lightwood-2276:Starting statistical analysis</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Finished statistical analysis</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Unable to import black formatter, predictor code might be a bit ugly.</span>
</pre></div></div>
</div>
</div>
<div class="section" id="Train">
<h2>Train<a class="headerlink" href="#Train" title="Permalink to this headline">¶</a></h2>
<p>Okay, everything is ready now for our predictor to learn based on the training data we will provide.</p>
<p>Internally, lightwood cleans and reshapes the data, featurizes measurements and timestamps, and comes up with a handful of different models that will be evaluated to keep the one that produces the best forecasts.</p>
<p>Let’s train the predictor. This should take a couple of minutes, at most:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictor</span><span class="o">.</span><span class="n">learn</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">INFO:lightwood-2276:[Learn phase 1/8] - Statistical analysis</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Starting statistical analysis</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Finished statistical analysis</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `analyze_data` runtime: 0.22 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:[Learn phase 2/8] - Data preprocessing</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Cleaning the data</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Transforming timeseries data</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Using 1 processes to reshape.</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `preprocess` runtime: 7.18 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:[Learn phase 3/8] - Data splitting</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Splitting the data into train/test</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `split` runtime: 0.0 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:[Learn phase 4/8] - Preparing encoders</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `prepare` runtime: 0.21 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:[Learn phase 5/8] - Feature generation</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Featurizing the data</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `featurize` runtime: 0.0 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:[Learn phase 6/8] - Mixer training</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Training the mixers</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
[LightGBM] [Fatal] GPU Tree Learner was not enabled in this build.
Please recompile with CMake option -DUSE_GPU=1
<span class="ansi-yellow-fg">WARNING:lightwood-2276:LightGBM running on CPU, this somewhat slower than the GPU version, consider using a GPU instead</span>
[LightGBM] [Fatal] GPU Tree Learner was not enabled in this build.
Please recompile with CMake option -DUSE_GPU=1
<span class="ansi-yellow-fg">WARNING:lightwood-2276:LightGBM running on CPU, this somewhat slower than the GPU version, consider using a GPU instead</span>
[LightGBM] [Fatal] GPU Tree Learner was not enabled in this build.
Please recompile with CMake option -DUSE_GPU=1
<span class="ansi-yellow-fg">WARNING:lightwood-2276:LightGBM running on CPU, this somewhat slower than the GPU version, consider using a GPU instead</span>
[LightGBM] [Fatal] GPU Tree Learner was not enabled in this build.
Please recompile with CMake option -DUSE_GPU=1
<span class="ansi-yellow-fg">WARNING:lightwood-2276:LightGBM running on CPU, this somewhat slower than the GPU version, consider using a GPU instead</span>
[LightGBM] [Fatal] GPU Tree Learner was not enabled in this build.
Please recompile with CMake option -DUSE_GPU=1
<span class="ansi-yellow-fg">WARNING:lightwood-2276:LightGBM running on CPU, this somewhat slower than the GPU version, consider using a GPU instead</span>
[LightGBM] [Fatal] GPU Tree Learner was not enabled in this build.
Please recompile with CMake option -DUSE_GPU=1
<span class="ansi-yellow-fg">WARNING:lightwood-2276:LightGBM running on CPU, this somewhat slower than the GPU version, consider using a GPU instead</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/torch/cuda/amp/grad_scaler.py:115: UserWarning: torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.
  warnings.warn(&#34;torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/pytorch_ranger/ranger.py:172: UserWarning: This overload of addcmul_ is deprecated:
        addcmul_(Number value, Tensor tensor1, Tensor tensor2)
Consider using one of the following signatures instead:
        addcmul_(Tensor tensor1, Tensor tensor2, *, Number value) (Triggered internally at  ../torch/csrc/utils/python_arg_parser.cpp:1025.)
  exp_avg_sq.mul_(beta2).addcmul_(1 - beta2, grad, grad)
<span class="ansi-green-fg">INFO:lightwood-2276:Loss of 0.585102379322052 with learning rate 0.0001</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss of 0.7148595452308655 with learning rate 0.00014</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Found learning rate of: 0.0001</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/torch/cuda/amp/grad_scaler.py:115: UserWarning: torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.
  warnings.warn(&#34;torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.&#34;)
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 1: 0.6456669121980667</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 2: 0.6410336345434189</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 3: 0.6354700475931168</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 4: 0.6291149407625198</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 5: 0.622087374329567</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 6: 0.6145201027393341</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 7: 0.6013990789651871</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 8: 0.5925582945346832</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 9: 0.5834362804889679</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 10: 0.5741055011749268</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 11: 0.5645492672920227</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 12: 0.5548561811447144</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 13: 0.539117231965065</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 14: 0.5291015207767487</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 15: 0.5191168040037155</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 16: 0.5091924220323563</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 17: 0.4992915093898773</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 18: 0.4894515424966812</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 19: 0.4737831801176071</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 20: 0.464065358042717</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 21: 0.4544946849346161</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 22: 0.4450710862874985</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 23: 0.4357172101736069</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 24: 0.4265916049480438</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 25: 0.41221916675567627</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 26: 0.40343764424324036</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 27: 0.39492469280958176</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 28: 0.38660094887018204</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 29: 0.3784591779112816</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 30: 0.3706289753317833</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 31: 0.3585698902606964</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 32: 0.3514317572116852</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 33: 0.3445679768919945</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 34: 0.33792024850845337</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 35: 0.33144232630729675</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 36: 0.32528067380189896</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 37: 0.31595388799905777</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 38: 0.31045491248369217</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 39: 0.30521319806575775</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 40: 0.3001890182495117</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 41: 0.2954143136739731</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 42: 0.29095523059368134</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 43: 0.2842651680111885</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 44: 0.2803710699081421</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 45: 0.27670125663280487</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 46: 0.2732877880334854</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 47: 0.2699630856513977</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 48: 0.26690319925546646</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 49: 0.26228082180023193</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 50: 0.25963667035102844</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 51: 0.25711993128061295</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 52: 0.2546876147389412</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 53: 0.252337746322155</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 54: 0.250296026468277</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 55: 0.24729792028665543</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 56: 0.24547016620635986</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 57: 0.24366508424282074</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 58: 0.24181529879570007</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 59: 0.23996565490961075</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 60: 0.23839619755744934</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 61: 0.23601987212896347</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 62: 0.23456569761037827</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 63: 0.23311860859394073</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 64: 0.23164322972297668</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 65: 0.23032398521900177</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 66: 0.22926850616931915</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 67: 0.22767256200313568</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 68: 0.2266520857810974</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 69: 0.22564685344696045</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 70: 0.22471066564321518</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 71: 0.22381749004125595</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 72: 0.22312259674072266</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 73: 0.2221302017569542</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 74: 0.22143280506134033</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 75: 0.22074522823095322</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 76: 0.22013459354639053</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 77: 0.21961483359336853</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 78: 0.21917980909347534</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 79: 0.2185639962553978</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 80: 0.2182188257575035</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 81: 0.21790385246276855</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 82: 0.2176167294383049</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 83: 0.2173519730567932</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 84: 0.21712063997983932</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 85: 0.2168426364660263</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 86: 0.21665059030056</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 87: 0.21645458787679672</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 88: 0.2162284553050995</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 89: 0.21599259972572327</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 90: 0.21577582508325577</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 91: 0.21549402177333832</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 92: 0.21529466658830643</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 93: 0.21513040363788605</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 94: 0.2149137780070305</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 95: 0.21469762176275253</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 96: 0.21452536433935165</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 97: 0.2143225520849228</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 98: 0.21416188031435013</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 99: 0.21403232961893082</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 100: 0.21386897563934326</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 101: 0.21367595344781876</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 102: 0.21354681998491287</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 103: 0.21345922350883484</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 104: 0.21333028376102448</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 105: 0.21318775415420532</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 106: 0.21302428096532822</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 107: 0.2127830982208252</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 108: 0.2126178741455078</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 109: 0.21247509121894836</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 110: 0.2123560607433319</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 111: 0.21216313540935516</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 112: 0.21191468834877014</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 113: 0.2116411179304123</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 114: 0.21143729984760284</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 115: 0.2112029641866684</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 116: 0.21107307076454163</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 117: 0.21093524992465973</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 118: 0.21063300967216492</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 119: 0.21038974076509476</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 120: 0.21021681278944016</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 121: 0.20992796123027802</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 122: 0.20983581990003586</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 123: 0.20985332131385803</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 124: 0.20942293852567673</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 125: 0.20917318761348724</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 126: 0.20899176597595215</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 127: 0.2087899148464203</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 128: 0.2085915356874466</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 129: 0.20846052467823029</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 130: 0.208277627825737</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 131: 0.20807652175426483</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 132: 0.2078895941376686</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 133: 0.20761697739362717</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 134: 0.20750880986452103</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 135: 0.20773112773895264</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/torch/cuda/amp/grad_scaler.py:115: UserWarning: torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.
  warnings.warn(&#34;torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.&#34;)
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 1: 0.15922766652974216</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 2: 0.16152603788809342</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 3: 0.16144210506569256</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 4: 0.16229942711916837</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 5: 0.1622449064796621</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `fit_mixer` runtime: 8.69 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Started fitting LGBM models for array prediction</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Started fitting LGBM model</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:A single GBM iteration takes 0.1 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Training GBM (&lt;module &#39;lightgbm&#39; from &#39;/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/__init__.py&#39;&gt;) with 38015 iterations given 4751.901495695114 seconds constraint</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Lightgbm model contains 24 weak estimators</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Updating lightgbm model with 1.5 iterations</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:Model now has a total of 25 weak estimators</span>
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:59: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data.data_frame[self.target] = train_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:60: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dev_data.data_frame[self.target] = dev_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
<span class="ansi-green-fg">INFO:lightwood-2276:Started fitting LGBM model</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:A single GBM iteration takes 0.1 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Training GBM (&lt;module &#39;lightgbm&#39; from &#39;/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/__init__.py&#39;&gt;) with 38015 iterations given 4751.903281450272 seconds constraint</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Lightgbm model contains 21 weak estimators</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Updating lightgbm model with 1 iterations</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:Model now has a total of 22 weak estimators</span>
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:59: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data.data_frame[self.target] = train_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:60: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dev_data.data_frame[self.target] = dev_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
<span class="ansi-green-fg">INFO:lightwood-2276:Started fitting LGBM model</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:A single GBM iteration takes 0.1 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Training GBM (&lt;module &#39;lightgbm&#39; from &#39;/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/__init__.py&#39;&gt;) with 38015 iterations given 4751.905344009399 seconds constraint</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Lightgbm model contains 15 weak estimators</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Updating lightgbm model with 1 iterations</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:Model now has a total of 16 weak estimators</span>
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:59: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data.data_frame[self.target] = train_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:60: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dev_data.data_frame[self.target] = dev_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
<span class="ansi-green-fg">INFO:lightwood-2276:Started fitting LGBM model</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:A single GBM iteration takes 0.1 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Training GBM (&lt;module &#39;lightgbm&#39; from &#39;/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/__init__.py&#39;&gt;) with 38015 iterations given 4751.905111551285 seconds constraint</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Lightgbm model contains 17 weak estimators</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Updating lightgbm model with 1 iterations</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:Model now has a total of 18 weak estimators</span>
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:59: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data.data_frame[self.target] = train_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:60: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dev_data.data_frame[self.target] = dev_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
<span class="ansi-green-fg">INFO:lightwood-2276:Started fitting LGBM model</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:A single GBM iteration takes 0.1 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Training GBM (&lt;module &#39;lightgbm&#39; from &#39;/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/__init__.py&#39;&gt;) with 38015 iterations given 4751.906681537628 seconds constraint</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Lightgbm model contains 14 weak estimators</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Updating lightgbm model with 1 iterations</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:Model now has a total of 15 weak estimators</span>
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:59: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data.data_frame[self.target] = train_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:60: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dev_data.data_frame[self.target] = dev_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
<span class="ansi-green-fg">INFO:lightwood-2276:Started fitting LGBM model</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:A single GBM iteration takes 0.1 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Training GBM (&lt;module &#39;lightgbm&#39; from &#39;/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/__init__.py&#39;&gt;) with 38015 iterations given 4751.904913663864 seconds constraint</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Lightgbm model contains 11 weak estimators</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Updating lightgbm model with 1 iterations</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:Model now has a total of 12 weak estimators</span>
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:65: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data.data_frame[self.target] = original_target_train
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:66: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  dev_data.data_frame[self.target] = original_target_dev
<span class="ansi-white-fg">DEBUG:lightwood-2276: `fit_mixer` runtime: 1.59 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Started fitting sktime forecaster for array prediction</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `fit_mixer` runtime: 72.03 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Ensembling the mixer</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Mixer: Neural got accuracy: 0.4888370997058768</span>
<span class="ansi-yellow-fg">WARNING:lightwood-2276:This model does not output probability estimates</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Mixer: LightGBMArray got accuracy: 0.35585091402445973</span>
<span class="ansi-yellow-fg">WARNING:lightwood-2276:This mixer does not output probability estimates</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Mixer: SkTime got accuracy: 0.2106632215259811</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Picked best mixer: Neural</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `fit` runtime: 83.33 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:[Learn phase 7/8] - Ensemble analysis</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Analyzing the ensemble of mixers</span>
<span class="ansi-green-fg">INFO:lightwood-2276:The block ICP is now running its analyze() method</span>
<span class="ansi-green-fg">INFO:lightwood-2276:The block AccStats is now running its analyze() method</span>
<span class="ansi-green-fg">INFO:lightwood-2276:The block ConfStats is now running its analyze() method</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `analyze_ensemble` runtime: 0.18 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:[Learn phase 8/8] - Adjustment on validation requested</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Updating the mixers</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/torch/cuda/amp/grad_scaler.py:115: UserWarning: torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.
  warnings.warn(&#34;torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.&#34;)
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 1: 0.16298051923513412</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 2: 0.16294610127806664</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 3: 0.16309829925497374</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 4: 0.16299538935224214</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Loss @ epoch 5: 0.16329597433408102</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Updating array of LGBM models...</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Updating lightgbm model with 1.5 iterations</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:Model now has a total of 26 weak estimators</span>
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:75: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data.data_frame[self.target] = train_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
<span class="ansi-green-fg">INFO:lightwood-2276:Updating lightgbm model with 1 iterations</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:Model now has a total of 23 weak estimators</span>
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:75: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data.data_frame[self.target] = train_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
<span class="ansi-green-fg">INFO:lightwood-2276:Updating lightgbm model with 1 iterations</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:Model now has a total of 17 weak estimators</span>
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:75: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data.data_frame[self.target] = train_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
<span class="ansi-green-fg">INFO:lightwood-2276:Updating lightgbm model with 1 iterations</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:Model now has a total of 19 weak estimators</span>
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:75: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data.data_frame[self.target] = train_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
<span class="ansi-green-fg">INFO:lightwood-2276:Updating lightgbm model with 1 iterations</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:Model now has a total of 16 weak estimators</span>
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:75: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data.data_frame[self.target] = train_data.data_frame[f&#39;{self.target}_timestep_{timestep}&#39;]
<span class="ansi-green-fg">INFO:lightwood-2276:Updating lightgbm model with 1 iterations</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:177: UserWarning: Found `num_iterations` in params. Will use it instead of argument
  _log_warning(f&#34;Found `{alias}` in params. Will use it instead of argument&#34;)
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/lightgbm/engine.py:240: UserWarning: &#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. Pass &#39;log_evaluation()&#39; callback via &#39;callbacks&#39; argument instead.
  _log_warning(&#34;&#39;verbose_eval&#39; argument is deprecated and will be removed in a future release of LightGBM. &#34;
<span class="ansi-green-fg">INFO:lightwood-2276:Model now has a total of 13 weak estimators</span>
/home/runner/work/lightwood/lightwood/lightwood/mixer/lightgbm_array.py:81: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  train_data.data_frame[self.target] = original_target_train
<span class="ansi-green-fg">INFO:lightwood-2276:Started fitting sktime forecaster for array prediction</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `adjust` runtime: 41.86 seconds</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `learn` runtime: 133.01 seconds</span>
</pre></div></div>
</div>
</div>
<div class="section" id="Predict">
<h2>Predict<a class="headerlink" href="#Predict" title="Permalink to this headline">¶</a></h2>
<p>Once the predictor has trained, we can use it to generate 6-month forecasts for each of the test set data points:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecasts</span> <span class="o">=</span> <span class="n">predictor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
<span class="ansi-green-fg">INFO:lightwood-2276:[Predict phase 1/4] - Data preprocessing</span>
/tmp/23b652178334a76ed7047f422c9f7b2f5f8bf2948a5a92fe16557258831820798.py:523: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  data[col] = [None] * len(data)
<span class="ansi-green-fg">INFO:lightwood-2276:Cleaning the data</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Transforming timeseries data</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `preprocess` runtime: 0.8 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:[Predict phase 2/4] - Feature generation</span>
<span class="ansi-green-fg">INFO:lightwood-2276:Featurizing the data</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `featurize` runtime: 0.0 seconds</span>
<span class="ansi-green-fg">INFO:lightwood-2276:[Predict phase 3/4] - Calling ensemble</span>
<span class="ansi-green-fg">INFO:lightwood-2276:[Predict phase 4/4] - Analyzing output</span>
/opt/hostedtoolcache/Python/3.9.13/x64/lib/python3.9/site-packages/pandas/core/indexing.py:1732: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self._setitem_single_block(indexer, value, name)
<span class="ansi-green-fg">INFO:lightwood-2276:The block ICP is now running its explain() method</span>
<span class="ansi-green-fg">INFO:lightwood-2276:The block AccStats is now running its explain() method</span>
<span class="ansi-green-fg">INFO:lightwood-2276:AccStats.explain() has not been implemented, no modifications will be done to the data insights.</span>
<span class="ansi-green-fg">INFO:lightwood-2276:The block ConfStats is now running its explain() method</span>
<span class="ansi-green-fg">INFO:lightwood-2276:ConfStats.explain() has not been implemented, no modifications will be done to the data insights.</span>
<span class="ansi-white-fg">DEBUG:lightwood-2276: `predict` runtime: 2.08 seconds</span>
</pre></div></div>
</div>
<p>Let’s check how a single row might look:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecasts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">10</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>original_index</th>
      <th>prediction</th>
      <th>order_Month</th>
      <th>confidence</th>
      <th>lower</th>
      <th>upper</th>
      <th>anomaly</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>[63.59237576155239, 65.84483175204892, 69.2671...</td>
      <td>[-271987200.0, -269308800.0, -266630400.0, -26...</td>
      <td>[0.59, 0.59, 0.59, 0.59, 0.59, 0.59]</td>
      <td>[51.33169105270977, 51.513959567656215, 53.165...</td>
      <td>[75.85306047039501, 80.17570393644162, 85.3686...</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>You’ll note that the point <code class="docutils literal notranslate"><span class="pre">prediction</span></code> has associated <code class="docutils literal notranslate"><span class="pre">lower</span></code> and <code class="docutils literal notranslate"><span class="pre">upper</span></code> bounds that are a function of the estimated <code class="docutils literal notranslate"><span class="pre">confidence</span></code> the model has on its own output. Apart from this, <code class="docutils literal notranslate"><span class="pre">order_Month</span></code> yields the timestamps of each prediction, the <code class="docutils literal notranslate"><span class="pre">anomaly</span></code> tag will let you know if the observed value falls outside of the predicted region.</p>
</div>
<div class="section" id="Visualizing-a-forecast">
<h2>Visualizing a forecast<a class="headerlink" href="#Visualizing-a-forecast" title="Permalink to this headline">¶</a></h2>
<p>Okay, time series are much easier to appreciate through plots. Let’s make one:</p>
<p>NOTE: We will use <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> to generate a simple plot of these forecasts. If you want to run this notebook locally, you will need to <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">matplotlib</span></code> for the following code to work.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">forecasts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">+</span> <span class="n">forecasts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;prediction&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;point prediction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">forecasts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">+</span> <span class="n">forecasts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;lower&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="kc">None</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">forecasts</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span> <span class="o">+</span> <span class="n">forecasts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;upper&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;timestep&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;# sunspots&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Forecasted amount of sunspots for the next semester&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_tutorial_time_series_tutorial_time_series_17_0.png" src="../../_images/tutorials_tutorial_time_series_tutorial_time_series_17_0.png" />
</div>
</div>
</div>
<div class="section" id="Conclusion">
<h2>Conclusion<a class="headerlink" href="#Conclusion" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial, we have gone through how you can train a machine learning model with Lightwood to produce forecasts for a univariate time series task.</p>
<p>There are additional parameters to further customize your timeseries settings and/or prediction insights, so be sure to check the rest of the documentation.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017-2022, MindsDB.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>